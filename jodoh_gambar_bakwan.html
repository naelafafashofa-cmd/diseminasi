<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Jodohkan Gambar & Teks - Drag & Drop (Versi 2)</title>
  <style>
    :root{
      --bg:#cff7dc; /* hijau muda */
      --area-bg:#ffffff; /* putih untuk teks area */
      --card-radius:10px;
      --gap:12px;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background:var(--bg);color:#06361f}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:28px}
    .container{width:1000px;max-width:96%;display:flex;flex-direction:column;gap:18px}

    .top{display:flex;justify-content:space-between;align-items:center}
    .title{font-weight:800;font-size:20px}
    .bank{display:flex;gap:10px;flex-wrap:wrap}
    .token{background:#fff;padding:8px 12px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);cursor:grab;user-select:none}
    .token[draggable="true"]:active{cursor:grabbing}

    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(255,255,255,0.9));padding:10px;border-radius:var(--card-radius);display:flex;flex-direction:column;align-items:center;gap:8px}
    .card img{max-width:100%;height:160px;object-fit:cover;border-radius:8px}
    .drop-area{width:100%;min-height:54px;background:var(--area-bg);border-radius:8px;border:2px dashed rgba(3,45,24,0.12);display:flex;align-items:center;justify-content:center;padding:6px}
    .drop-area.filled{border-style:solid}
    .drop-area span{color:#042612}

    .controls{display:flex;gap:10px;justify-content:flex-end}
    button{padding:10px 14px;border-radius:8px;border:none;font-weight:700;cursor:pointer}
    .btn-primary{background:#0b6b3a;color:white}
    .btn-muted{background:#e8f7ec;color:#074327}

    .feedback{padding:10px;border-radius:8px;font-weight:700;display:none}
    .feedback.success{background:rgba(6,102,48,0.12);color:#064f2b;display:block}
    .feedback.error{background:rgba(102,6,6,0.08);color:#6b0b0b;display:block}

    @media (max-width:860px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:480px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="container">
      <div class="top">
        <div class="title">Jodohkan Gambar dan Teks (Tarik & Lepas)</div>
        <div class="bank" id="bank">
          <!-- draggable tokens appear here -->
        </div>
      </div>

      <div class="grid" id="grid">
        <!-- cards generated by JS -->
      </div>

      <div style="display:flex;justify-content:flex-end;gap:12px;align-items:center">
        <div id="feedback" class="feedback" role="status" aria-live="polite"></div>
        <div class="controls">
          <button id="checkBtn" class="btn-primary">HASIL</button>
          <button id="resetBtn" class="btn-muted">RESET</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Gambar (dengan encoding spasi)
    const images = [
      {id:'gambar1', src: encodeURI('https://naelafafashofa-cmd.github.io/diseminasi/bakwan daun singkong.jpg')},
      {id:'gambar2', src: encodeURI('https://naelafafashofa-cmd.github.io/diseminasi/bakwan jagung.jpg')},
      {id:'gambar3', src: encodeURI('https://naelafafashofa-cmd.github.io/diseminasi/bakwan sayur.jpg')},
      {id:'gambar4', src: encodeURI('https://naelafafashofa-cmd.github.io/diseminasi/bakwan udang.jpg')}
    ];

    // Teks/token sesuai permintaan. Saya koreksi teks ke-3 menjadi "Bakwan Sayur" karena gambar3 adalah bakwan sayur.
    const tokens = [
      {id:'t1', text:'Bakwan Daun Singkong'},
      {id:'t2', text:'Bakwan Jagung'},
      {id:'t3', text:'Bakwan Sayur'},
      {id:'t4', text:'Bakwan Udang'}
    ];

    // Jawaban benar berdasarkan nama file gambar:
    const correctMap = {
      'gambar1':'Bakwan Daun Singkong',
      'gambar2':'Bakwan Jagung',
      'gambar3':'Bakwan Sayur',
      'gambar4':'Bakwan Udang'
    };

    const bankEl = document.getElementById('bank');
    const gridEl = document.getElementById('grid');
    const feedbackEl = document.getElementById('feedback');

    // util shuffle
    function shuffle(a){
      for(let i=a.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];
      }
    }

    // Render bank tokens
    function renderBank(list){
      bankEl.innerHTML='';
      list.forEach(t=>{
        const btn = document.createElement('button');
        btn.className='token';
        btn.textContent = t.text;
        btn.draggable = true;
        btn.dataset.text = t.text;
        btn.addEventListener('dragstart', onDragStart);
        btn.addEventListener('keydown', e=>{ if(e.key==='Enter'){ addTokenToFirstEmpty(t); } });
        btn.addEventListener('dblclick', ()=> addTokenToFirstEmpty(t));
        bankEl.appendChild(btn);
      });
    }

    function onDragStart(e){
      e.dataTransfer.setData('text/plain', e.target.dataset.text);
      e.dataTransfer.effectAllowed = 'move';
    }

    // Render image cards
    function renderCards(imgs){
      gridEl.innerHTML='';
      imgs.forEach(img=>{
        const card = document.createElement('div');
        card.className='card';
        card.dataset.id = img.id;

        const image = document.createElement('img');
        image.src = img.src;
        image.alt = img.id;

        const drop = document.createElement('div');
        drop.className='drop-area';
        drop.dataset.target = img.id;
        drop.innerHTML = '<span>Tarik teks ke sini</span>';
        drop.addEventListener('dragover', e=>e.preventDefault());
        drop.addEventListener('drop', e=>{
          e.preventDefault();
          const text = e.dataTransfer.getData('text/plain');
          if(!text) return;
          fillDrop(drop, text);
          removeTokenFromBank(text);
        });

        // klik untuk mengosongkan (kembalikan token)
        drop.addEventListener('click', ()=>{
          if(drop.dataset.filled){
            returnTokenToBank(drop.dataset.filled);
            clearDrop(drop);
          }
        });

        card.appendChild(image);
        card.appendChild(drop);
        gridEl.appendChild(card);
      });
    }

    function fillDrop(dropEl, text){
      dropEl.classList.add('filled');
      dropEl.innerHTML = `<span>${text}</span>`;
      dropEl.dataset.filled = text;
    }
    function clearDrop(dropEl){
      dropEl.classList.remove('filled');
      dropEl.innerHTML = '<span>Tarik teks ke sini</span>';
      delete dropEl.dataset.filled;
    }

    function removeTokenFromBank(text){
      const btns = Array.from(bankEl.querySelectorAll('.token'));
      const btn = btns.find(b=>b.dataset.text===text);
      if(btn) btn.remove();
    }

    function returnTokenToBank(text){
      const exists = Array.from(bankEl.querySelectorAll('.token')).some(b=>b.dataset.text===text);
      if(!exists){
        const btn = document.createElement('button');
        btn.className='token';
        btn.textContent = text;
        btn.draggable = true;
        btn.dataset.text = text;
        btn.addEventListener('dragstart', onDragStart);
        btn.addEventListener('dblclick', ()=> addTokenToFirstEmpty({text}));
        bankEl.appendChild(btn);
      }
    }

    function addTokenToFirstEmpty(token){
      const drops = Array.from(document.querySelectorAll('.drop-area'));
      const empty = drops.find(d=>!d.dataset.filled);
      if(empty){
        fillDrop(empty, token.text);
        removeTokenFromBank(token.text);
      }
    }

    // Check answers
    document.getElementById('checkBtn').addEventListener('click', ()=>{
      const cards = Array.from(document.querySelectorAll('.card'));
      const userMap = {};
      let allFilled = true;
      cards.forEach(c=>{
        const id = c.dataset.id;
        const drop = c.querySelector('.drop-area');
        const val = drop.dataset.filled || '';
        if(!val) allFilled = false;
        userMap[id]=val;
      });

      if(!allFilled){
        showFeedback('Maaf. Mohon isi semua kotak dulu.','error');
        return;
      }

      const ok = Object.keys(correctMap).every(id => correctMap[id] === userMap[id]);
      if(ok) showFeedback('Hebat. Jawaban anda benar','success');
      else showFeedback('Maaf. Jawaban anda salah. Ulangi lagi','error');
    });

    function showFeedback(msg, type){
      feedbackEl.textContent = msg;
      feedbackEl.className = 'feedback ' + (type==='success' ? 'success' : 'error');
      setTimeout(()=>{ feedbackEl.className='feedback'; feedbackEl.textContent=''; },4000);
    }

    // Reset
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      init();
      feedbackEl.textContent='';
      feedbackEl.className='feedback';
    });

    // Initialize
    function init(){
      const imgs = [...images]; shuffle(imgs);
      renderCards(imgs);
      const t = [...tokens]; shuffle(t);
      renderBank(t);
    }

    init();

  </script>
</body>
</html>